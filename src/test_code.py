import numpy as np
import os
import torch
from tqdm import tqdm

a=[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3]
a=torch.tensor(a)
# 5
idx_list=[10,11,12,13,14]
idx_list=torch.tensor(idx_list)
# 30x4
input=torch.tensor([[0.1,0.2,0.3,0.4],
                    [0.5,0.6,0.7,0.8],
                    [0.9,1.0,0.1,0.2],
                    [0.3,0.4,0.5,0.6],
                    [0.7,0.8,0.9,1.0],
                    [0.1,0.2,0.3,0.4],
                    [0.5,0.6,0.7,0.8],
                    [0.9,1.0,0.1,0.2],
                    [0.3,0.4,0.5,0.6],
                    [0.7,0.8,0.9,1.0],
                    [0.2, 0.2, 0.3, 0.4],
                    [0.6, 0.6, 0.7, 0.8],
                    [0.1, 1.0, 0.1, 0.2],
                    [0.5, 0.4, 0.5, 0.6],
                    [0.1, 0.8, 0.9, 1.0],
                    [0.1, 0.2, 0.3, 0.4],
                    [0.5, 0.6, 0.7, 0.8],
                    [0.9, 1.0, 0.1, 0.2],
                    [0.3, 0.4, 0.5, 0.6],
                    [0.7, 0.8, 0.9, 1.0],
                    [0.1, 0.2, 0.3, 0.4],
                    [0.5, 0.6, 0.7, 0.8],
                    [0.9, 1.0, 0.1, 0.2],
                    [0.3, 0.4, 0.5, 0.6],
                    [0.7, 0.8, 0.9, 1.0],
                    [0.1, 0.2, 0.3, 0.4],
                    [0.5, 0.6, 0.7, 0.8],
                    [0.9, 1.0, 0.1, 0.2],
                    [0.3, 0.4, 0.5, 0.6],
                    [0.7, 0.8, 0.9, 1.0]])
print(input[idx_list].mean(0))


